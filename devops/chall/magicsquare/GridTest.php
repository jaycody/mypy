<?php

require_once 'Grid.php';

class GridTest extends PHPUnit_Framework_TestCase
{
    /**
     * @dataProvider magicSquaresProvider
     * @group standard
     */
    public function testMagicSquares(array $arrangement, $expected)
    {
        $this->assertSame($expected, 
            (new Grid($arrangement))->isMagicSquare());
    }

    public function magicSquaresProvider()
    {
        return [
            [[8, 1, 6, 3, 5, 7, 4, 9, 2], true],
            [[2, 7, 6, 9, 5, 1, 4, 3, 8], true],
            [[8, 6, 1, 3, 5, 7, 4, 9, 2], false],
            [[16, 3, 2, 13, 5, 10, 11, 8, 9, 6, 7, 12, 4, 15, 14, 1], true],
            [[12, 6, 15, 1, 13, 3, 10, 8, 2, 16, 5, 11, 7, 9, 4, 14], true],
            [[1, 10, 12, 5, 13, 15, 11, 2, 3, 16, 4, 6, 14, 7, 8, 9], false],
        ];
    }

    /**
     * @dataProvider largeMagicSquaresProvider
     * @group large
     */
    public function testLargeMagicSquares(array $arrangement, $expected)
    {
        $this->assertSame($expected, 
            (new Grid($arrangement))->isMagicSquare());
    }

    public function largeMagicSquaresProvider()
    {
        return [
            [[92, 99, 1, 8, 15, 67, 74, 51, 58, 40, 98, 80, 7, 14, 16, 73, 55, 57, 64, 41, 4, 81, 88, 20, 22, 54, 56, 63, 
              70, 47, 85, 87, 19, 21, 3, 60, 62, 69, 71, 28, 86, 93, 25, 2, 9, 61, 68, 75, 52, 34, 17, 24, 76, 83, 90, 42, 
              49, 26, 33, 65, 23, 5, 82, 89, 91, 48, 30, 32, 39, 66, 79, 6, 13, 95, 97, 29, 31, 38, 45, 72, 10, 12, 94, 
              96, 78, 35, 37, 44, 46, 53, 11, 18, 100, 77, 84, 36, 43, 50, 27, 59], true],
            [[92, 99, 1, 8, 15, 67, 74, 51, 58, 40, 98, 80, 7, 14, 16, 73, 55, 57, 64, 41, 4, 81, 88, 20, 22, 54, 56, 63, 
              70, 47, 85, 87, 19, 21, 3, 60, 62, 69, 71, 28, 86, 93, 25, 2, 9, 61, 68, 75, 52, 34, 17, 24, 76, 83, 90, 42, 
              49, 26, 33, 65, 23, 5, 82, 89, 91, 48, 30, 32, 39, 66, 79, 6, 13, 95, 97, 29, 31, 38, 45, 72, 10, 12, 94, 
              96, 78, 35, 37, 44, 46, 53, 11, 18, 100, 77, 84, 36, 43, 50, 59, 27], false],
            [[144, 2, 3, 141, 140, 6, 7, 137, 136, 10, 11, 133, 13, 131, 130, 16, 17, 127, 126, 20, 21, 123, 122, 24, 25, 
              119, 118, 28, 29, 115, 114, 32, 33, 111, 110, 36, 108, 38, 39, 105, 104, 42, 43, 101, 100, 46, 47, 97, 96, 
              50, 51, 93, 92, 54, 55, 89, 88, 58, 59, 85, 61, 83, 82, 64, 65, 79, 78, 68, 69, 75, 74, 72, 73, 71, 70, 76, 
              77, 67, 66, 80, 81, 63, 62, 84, 60, 86, 87, 57, 56, 90, 91, 53, 52, 94, 95, 49, 48, 98, 99, 45, 44, 102, 103, 
              41, 40, 106, 107, 37, 109, 35, 34, 112, 113, 31, 30, 116, 117, 27, 26, 120, 121, 23, 22, 124, 125, 19, 18, 128, 
              129, 15, 14, 132, 12, 134, 135, 9, 8, 138, 139, 5, 4, 142, 143, 1], true],
            [[144, 2, 3, 141, 140, 6, 7, 137, 136, 10, 11, 133, 13, 131, 130, 16, 17, 127, 126, 20, 21, 123, 122, 24, 25, 
              119, 118, 28, 29, 115, 114, 32, 33, 111, 110, 36, 108, 38, 39, 105, 104, 42, 43, 101, 100, 46, 47, 97, 96, 
              50, 51, 93, 92, 54, 55, 89, 88, 58, 59, 85, 61, 83, 82, 64, 65, 79, 78, 68, 69, 75, 74, 72, 73, 71, 70, 76, 
              77, 67, 66, 80, 81, 63, 62, 84, 60, 86, 87, 57, 56, 90, 91, 53, 52, 94, 95, 49, 48, 98, 99, 45, 44, 102, 103, 
              41, 40, 106, 107, 37, 109, 35, 34, 112, 113, 31, 30, 116, 117, 27, 26, 120, 121, 23, 22, 124, 125, 19, 18, 128, 
              129, 15, 14, 132, 12, 134, 135, 9, 8, 138, 139, 5, 4, 1, 142, 143], false],
            [[130, 115, 280, 88, 359, 44, 356, 89, 358, 361, 78, 81, 79, 308, 311, 314, 54, 309, 95, 201, 169, 324, 86, 369, 38, 365, 28, 375, 71, 82, 384, 367, 331, 80, 47, 62, 351, 53, 329, 99, 304, 76, 400, 22, 262, 167, 248, 4, 205, 206, 122, 252, 383, 52, 192, 332, 83, 335, 55, 310, 101, 399, 24, 250, 249, 199, 245, 235, 31, 23, 305, 221, 58, 385, 326, 161, 244, 136, 355, 63, 100, 396, 30, 162, 273, 251, 276, 277, 290, 296, 3, 179, 59, 389, 185, 110, 247, 103, 57, 327, 295, 7, 366, 163, 135, 214, 102, 230, 159, 129, 208, 20, 212, 236, 382, 226, 294, 233, 334, 65, 303, 6, 109, 386, 256, 210, 229, 123, 155, 257, 213, 11, 254, 225, 243, 362, 173, 118, 49, 328, 307, 21, 372, 194, 285, 204, 133, 170, 141, 218, 289, 190, 14, 119, 117, 393, 108, 333, 341, 61, 41, 345, 297, 388, 113, 253, 140, 220, 127, 269, 126, 198, 217, 10, 263, 137, 364, 134, 51, 317, 337, 25, 182, 120, 368, 186, 178, 143, 237, 114, 227, 255, 259, 131, 27, 241, 224, 392, 48, 316, 85, 353, 9, 177, 160, 374, 270, 142, 146, 174, 287, 164, 258, 223, 215, 33, 281, 219, 376, 64, 84, 350, 267, 37, 264, 138, 391, 184, 203, 275, 132, 274, 181, 261, 148, 288, 13, 104, 56, 360, 340, 60, 68, 293, 8, 284, 282, 387, 211, 112, 183, 260, 231, 268, 197, 116, 207, 29, 380, 94, 73, 352, 283, 228, 39, 158, 176, 147, 390, 188, 144, 246, 278, 172, 191, 145, 15, 292, 395, 98, 336, 67, 168, 107, 175, 19, 165, 189, 381, 193, 272, 242, 171, 299, 187, 266, 238, 35, 394, 106, 74, 344, 298, 154, 291, 216, 12, 342, 222, 398, 105, 111, 124, 125, 150, 128, 239, 371, 5, 301, 338, 46, 265, 157, 240, 75, 16, 343, 180, 96, 378, 370, 166, 156, 202, 152, 151, 377, 2, 300, 91, 346, 66, 318, 69, 209, 349, 18, 149, 279, 195, 196, 397, 153, 234, 139, 379, 1, 325, 97, 302, 72, 348, 50, 339, 354, 321, 70, 34, 17, 319, 330, 26, 373, 36, 363, 32, 315, 77, 232, 200, 306, 92, 347, 87, 90, 93, 322, 320, 323, 40, 43, 312, 45, 357, 42, 313, 121, 286, 271], true],
            [[115, 130, 280, 88, 359, 44, 356, 89, 358, 361, 78, 81, 79, 308, 311, 314, 54, 309, 95, 201, 169, 324, 86, 369, 38, 365, 28, 375, 71, 82, 384, 367, 331, 80, 47, 62, 351, 53, 329, 99, 304, 76, 400, 22, 262, 167, 248, 4, 205, 206, 122, 252, 383, 52, 192, 332, 83, 335, 55, 310, 101, 399, 24, 250, 249, 199, 245, 235, 31, 23, 305, 221, 58, 385, 326, 161, 244, 136, 355, 63, 100, 396, 30, 162, 273, 251, 276, 277, 290, 296, 3, 179, 59, 389, 185, 110, 247, 103, 57, 327, 295, 7, 366, 163, 135, 214, 102, 230, 159, 129, 208, 20, 212, 236, 382, 226, 294, 233, 334, 65, 303, 6, 109, 386, 256, 210, 229, 123, 155, 257, 213, 11, 254, 225, 243, 362, 173, 118, 49, 328, 307, 21, 372, 194, 285, 204, 133, 170, 141, 218, 289, 190, 14, 119, 117, 393, 108, 333, 341, 61, 41, 345, 297, 388, 113, 253, 140, 220, 127, 269, 126, 198, 217, 10, 263, 137, 364, 134, 51, 317, 337, 25, 182, 120, 368, 186, 178, 143, 237, 114, 227, 255, 259, 131, 27, 241, 224, 392, 48, 316, 85, 353, 9, 177, 160, 374, 270, 142, 146, 174, 287, 164, 258, 223, 215, 33, 281, 219, 376, 64, 84, 350, 267, 37, 264, 138, 391, 184, 203, 275, 132, 274, 181, 261, 148, 288, 13, 104, 56, 360, 340, 60, 68, 293, 8, 284, 282, 387, 211, 112, 183, 260, 231, 268, 197, 116, 207, 29, 380, 94, 73, 352, 283, 228, 39, 158, 176, 147, 390, 188, 144, 246, 278, 172, 191, 145, 15, 292, 395, 98, 336, 67, 168, 107, 175, 19, 165, 189, 381, 193, 272, 242, 171, 299, 187, 266, 238, 35, 394, 106, 74, 344, 298, 154, 291, 216, 12, 342, 222, 398, 105, 111, 124, 125, 150, 128, 239, 371, 5, 301, 338, 46, 265, 157, 240, 75, 16, 343, 180, 96, 378, 370, 166, 156, 202, 152, 151, 377, 2, 300, 91, 346, 66, 318, 69, 209, 349, 18, 149, 279, 195, 196, 397, 153, 234, 139, 379, 1, 325, 97, 302, 72, 348, 50, 339, 354, 321, 70, 34, 17, 319, 330, 26, 373, 36, 363, 32, 315, 77, 232, 200, 306, 92, 347, 87, 90, 93, 322, 320, 323, 40, 43, 312, 45, 357, 42, 313, 121, 286, 271], false],
        ];
    }

    /**
     * @dataProvider invalidMagicSquareGridProvider
     * @expectedException InvalidArgumentException
     * @group extracredit
     */
    public function testInvalidMagicSquareGrid($arrangement)
    {
        (new Grid($arrangement))->isMagicSquare();
    }

    public function invalidMagicSquareGridProvider()
    {
        return [
            [[1, 2, 3, 4, 5, 6, 7]], // not a square
            [[1, 2, 3, 4, 5, 6, 7, 7]], // duplicate number
            [[1, 2, 3, 5, 5, 6, 7, 7]], // duplicate numbers
            [[1, 2, 3, 4, 5, 6, 7, 9]], // number out of range 1..n^2
            [[144, 144, 3, 141, 140, 6, 7, 137, 136, 10, 11, 133, 13, 131, 130, 16, 17, 127, 126, 20, 21, 123, 122, 24, 25, 
              119, 118, 28, 29, 115, 114, 32, 33, 111, 110, 36, 108, 38, 39, 105, 104, 42, 43, 101, 100, 46, 47, 97, 96, 
              50, 51, 93, 92, 54, 55, 89, 88, 58, 59, 85, 61, 83, 82, 64, 65, 79, 78, 68, 69, 75, 74, 72, 73, 71, 70, 76, 
              77, 67, 66, 80, 81, 63, 62, 84, 60, 86, 87, 57, 56, 90, 91, 53, 52, 94, 95, 49, 48, 98, 99, 45, 44, 102, 103, 
              41, 40, 106, 107, 37, 109, 35, 34, 112, 113, 31, 30, 116, 117, 27, 26, 120, 121, 23, 22, 124, 125, 19, 18, 128, 
              129, 15, 14, 132, 12, 134, 135, 9, 8, 138, 139, 5, 4, 1, 142, 143]],
            [[99999, 130, 280, 88, 359, 44, 356, 89, 358, 361, 78, 81, 79, 308, 311, 314, 54, 309, 95, 201, 169, 324, 86, 369, 38, 365, 28, 375, 71, 82, 384, 367, 331, 80, 47, 62, 351, 53, 329, 99, 304, 76, 400, 22, 262, 167, 248, 4, 205, 206, 122, 252, 383, 52, 192, 332, 83, 335, 55, 310, 101, 399, 24, 250, 249, 199, 245, 235, 31, 23, 305, 221, 58, 385, 326, 161, 244, 136, 355, 63, 100, 396, 30, 162, 273, 251, 276, 277, 290, 296, 3, 179, 59, 389, 185, 110, 247, 103, 57, 327, 295, 7, 366, 163, 135, 214, 102, 230, 159, 129, 208, 20, 212, 236, 382, 226, 294, 233, 334, 65, 303, 6, 109, 386, 256, 210, 229, 123, 155, 257, 213, 11, 254, 225, 243, 362, 173, 118, 49, 328, 307, 21, 372, 194, 285, 204, 133, 170, 141, 218, 289, 190, 14, 119, 117, 393, 108, 333, 341, 61, 41, 345, 297, 388, 113, 253, 140, 220, 127, 269, 126, 198, 217, 10, 263, 137, 364, 134, 51, 317, 337, 25, 182, 120, 368, 186, 178, 143, 237, 114, 227, 255, 259, 131, 27, 241, 224, 392, 48, 316, 85, 353, 9, 177, 160, 374, 270, 142, 146, 174, 287, 164, 258, 223, 215, 33, 281, 219, 376, 64, 84, 350, 267, 37, 264, 138, 391, 184, 203, 275, 132, 274, 181, 261, 148, 288, 13, 104, 56, 360, 340, 60, 68, 293, 8, 284, 282, 387, 211, 112, 183, 260, 231, 268, 197, 116, 207, 29, 380, 94, 73, 352, 283, 228, 39, 158, 176, 147, 390, 188, 144, 246, 278, 172, 191, 145, 15, 292, 395, 98, 336, 67, 168, 107, 175, 19, 165, 189, 381, 193, 272, 242, 171, 299, 187, 266, 238, 35, 394, 106, 74, 344, 298, 154, 291, 216, 12, 342, 222, 398, 105, 111, 124, 125, 150, 128, 239, 371, 5, 301, 338, 46, 265, 157, 240, 75, 16, 343, 180, 96, 378, 370, 166, 156, 202, 152, 151, 377, 2, 300, 91, 346, 66, 318, 69, 209, 349, 18, 149, 279, 195, 196, 397, 153, 234, 139, 379, 1, 325, 97, 302, 72, 348, 50, 339, 354, 321, 70, 34, 17, 319, 330, 26, 373, 36, 363, 32, 315, 77, 232, 200, 306, 92, 347, 87, 90, 93, 322, 320, 323, 40, 43, 312, 45, 357, 42, 313, 121, 286, 271]],
        ];
    }

}
